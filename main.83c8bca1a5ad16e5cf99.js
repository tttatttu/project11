!function(e){var t={};function r(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(s,o,function(t){return e[t]}.bind(null,o));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){},function(e,t,r){"use strict";r.r(t);r(0);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class o{constructor(e,t,r,o){s(this,"_remove",e=>{e.stopPropagation(),this._card.remove()}),s(this,"_renderImagePopup",()=>{const e=this._card.querySelector(".place-card__image").style.backgroundImage.slice(5,-2);this.popupImg.popup.querySelector(".popup__images").src=""+e,this.popupImg.openPopup()}),this.item=e,this.popupImg=t,this.template=r,this.api=o}_like(e){e.target.classList.toggle("place-card__like-icon_liked")}render(){return this._card=this.template.cloneNode(!0),this._card.querySelector(".place-card__name").textContent=this.item.name,this._card.querySelector(".place-card__image").style.backgroundImage=`url(${this.item.link})`,this.addEventListeners(),this._card}addEventListeners(){this._card.querySelector(".place-card__like-icon").addEventListener("click",this._like),this._card.querySelector(".place-card__image").addEventListener("click",this._renderImagePopup),this._card.querySelector(".place-card__delete-icon").addEventListener("click",this._remove)}}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class i{constructor(e,t){n(this,"checkinputsValidity",e=>(e.setCustomValidity(""),e.validity.valueMissing?(e.setCustomValidity(this.errorMessages.empty),!1):e.validity.tooShort||e.validity.tooLong?(e.setCustomValidity(this.errorMessages.wrongLength),!1):e.validity.typeMismatch&&"url"===e.type?(e.setCustomValidity(this.errorMessages.wrongUrl),!1):e.checkValidity())),n(this,"isFieldValid",e=>{const t=this.form.querySelector(`#${e.id}-error`),r=this.checkinputsValidity(e);return t.textContent=e.validationMessage,r}),this.form=e,this.errorMessages=t,this.button=e.querySelector(".popup__button")}setSubmitButtonState(e,t){t?e.removeAttribute("disabled"):e.setAttribute("disabled",!0)}resetError(){this.form.querySelectorAll(".error").forEach(e=>{""!==e.textContent&&(e.textContent="")})}resetForm(){this.form.reset()}setEventListeners(){this.form.addEventListener("input",e=>{const t=this.form.querySelector(".button"),[...r]=this.form.querySelectorAll(".popup__input");this.isFieldValid(e.target),this.setSubmitButtonState(t,r.every(this.checkinputsValidity))})}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u{constructor(e){a(this,"openPopup",()=>{this.addListeners(),this.popup.classList.add("popup_is-opened")}),a(this,"closePopup",()=>{this.removeListeners(),this.popup.classList.remove("popup_is-opened")}),a(this,"addListeners",()=>{this.popup.querySelector(".popup__close").addEventListener("click",this.closePopup)}),this.popup=e,this.form=e.querySelector(".popup__form")}removeListeners(){this.popup.querySelector(".popup__close").removeEventListener("click",this.closePopup)}}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=document.querySelector(".places-list"),p=document.querySelector("#cardlist-template").content.querySelector(".place-card"),d=new u(document.getElementById("popup__img")),h={baseUrl:"https://praktikum.tk/cohort11/",headers:{authorization:"97003477-34f8-401f-bc72-5e2a641b9a11","Content-Type":"application/json"}},m=new class{constructor(e){var t,r,s;s=e=>e.ok?e.json():Promise.reject("Ошибка: "+e.status),(r="_getResponseData")in(t=this)?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,this.baseUrl=e.baseUrl,this.headers=e.headers}getUser(){return fetch(this.baseUrl+"/users/me",{headers:this.headers}).then(e=>this._getResponseData(e))}getCards(){return fetch(this.baseUrl+"/cards",{headers:this.headers}).then(e=>this._getResponseData(e))}updateUser(e){return fetch(this.baseUrl+"/users/me",{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.about})}).then(e=>this._getResponseData(e))}}(h),f=document.getElementById("popup__edit"),b=document.querySelector(".user-info__edit"),_=document.getElementById("popup__add"),y=document.querySelector(".user-info__button"),g=new u(f),v=new u(_),S=new class{constructor(e,t,r,s,o){this._container=e,this._createCard=t,this.popupImg=r,this.template=s,this.api=o}addCard(e){const t=this._createCard(e,this.popupImg,this.template,this.api);this._container.append(t)}}(l,(...e)=>new o(...e).render(),d,p,m),k=document.querySelector(".user-info__name"),L=document.querySelector(".user-info__job"),q=new class{constructor(e,t,r){c(this,"setUserInfo",(e,t)=>{this.person.textContent=e,this.about.textContent=t}),c(this,"updateUserInfo",e=>{const{name:t,job:r}=e.elements;t.value=this.person.textContent,r.value=this.about.textContent}),this.person=e,this.about=t,this.api=r}}(k,L,m),P={empty:"Это обязательное поле",wrongLength:"Должно быть от 2 до 30 символов",wrongUrl:"Здесь должна быть ссылка"},E=new i(v.form,P),C=new i(g.form,P);m.getCards().then(e=>{e.forEach(e=>{S.addCard(e)})}).catch(e=>{console.log("Ошибка. Запрос не выполнен: ",e)}),m.getUser().then(e=>{q.setUserInfo(e.name,e.about)}).catch(e=>console.log(e)),v.form.addEventListener("submit",e=>{e.preventDefault();const t=v.form.querySelector("#name"),r=v.form.querySelector("#link");S.addCard({name:t,link:r}),v.closePopup()}),y.addEventListener("click",()=>{E.button.setAttribute("disabled",!0),E.resetForm(),E.resetError(),E.setEventListeners(),v.openPopup()}),g.form.addEventListener("submit",e=>{e.preventDefault();const t=g.form.name.value,r=g.form.job.value;m.updateUser({name:t,about:r}).then(e=>{q.setUserInfo(e.name,e.about),g.closePopup()}).catch(e=>console.log(e))}),b.addEventListener("click",()=>{C.button.removeAttribute("disabled"),q.updateUserInfo(g.form),C.resetError(),C.setEventListeners(),g.openPopup()})}]);